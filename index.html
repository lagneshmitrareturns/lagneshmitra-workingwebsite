<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>LagneshMitra | Vedic Astrology & Publishing Factory</title>

  <meta name="description"
        content="Structured Vedic Astrology. Marriage, Karmic Debt, Advanced Analysis. Early Access Booking Open for Kaalprehari â€“ The Dera Massacre.">

  <link rel="stylesheet" href="style.css" />
</head>

<body>

  <!-- HEADER -->
  <header>
    <div class="container">
      <div class="logo">LagneshMitra</div>
      <div class="tagline">Vedic Astrology â€¢ Structured â€¢ Not Guesswork</div>
    </div>
  </header>


  <!-- HERO -->
  <section class="hero">
    <div class="container">
      <h1>Clarity. Timing. Structure.</h1>
      <p>Astrology with Logic â€¢ Publishing with Vision</p>

      <div class="cta-buttons">
        <a href="#consult" class="btn">Book Consultation</a>
        <a href="#book" class="btn secondary">Kaalprehari â€“ Early Access</a>
      </div>
    </div>
  </section>


  <!-- CONSULTATION SECTION -->
  <section id="consult" class="section">
    <div class="container">

      <h2>Consultation Services</h2>

      <div class="services">
        <div class="service-card">
          <h3>Short Structured Consultation</h3>
          <p>Direct answers. No fluff.</p>
        </div>

        <div class="service-card">
          <h3>Marriage & Compatibility</h3>
          <p>Timing + Karmic factors.</p>
        </div>

        <div class="service-card">
          <h3>Karmic Debt Analysis</h3>
          <p>D30 / D60 deep decoding.</p>
        </div>

        <div class="service-card">
          <h3>Advanced Premium Analysis</h3>
          <p>Full structured breakdown.</p>
        </div>
      </div>

      <form id="consultForm" class="form">
        <input type="text" id="fullName" placeholder="Full Name" required />
        <input type="email" id="email" placeholder="Email Address" required />
        <textarea id="message" placeholder="Your Query"></textarea>
        <button type="submit" class="btn">Submit Query</button>
      </form>

    </div>
  </section>


  <!-- BOOK SECTION -->
  <section id="book" class="section dark">
    <div class="container">

      <h2>Kaalprehari â€“ The Dera Massacre</h2>

      <img src="kaalprehari.jpg"
           alt="Kaalprehari Book Cover"
           class="book-cover"
           id="bookImage" />

      <p class="book-desc">
        Supernatural Commercial Thriller <br>
        Early Booking Open â€¢ Ebook â‚¹99 <br>
        Worldwide Release on KDP & Other Platforms
      </p>

      <form id="bookForm" class="form">
        <input type="text" id="bookName" placeholder="Full Name" required />
        <input type="email" id="bookEmail" placeholder="Email Address" required />

        <select id="interestedIn" required>
          <option value="">Interested In</option>
          <option value="ebook">Ebook</option>
          <option value="paperback">Paperback</option>
          <option value="hardcover">Hardcover</option>
        </select>

        <button type="submit" class="btn">Book Early Access</button>
      </form>

    </div>
  </section>


  <!-- FOOTER -->
  <footer>
    Â© LagneshMitra & Zonies Hub Originals
  </footer>



  <!-- FIREBASE MODULE -->
  <script type="module">

    import { db } from "./firebase-config.js";
    import {
      collection,
      addDoc,
      serverTimestamp
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";


    /* ==========================
       VISIT TRACKING
    ========================== */

    async function trackVisit() {
      try {
        await addDoc(collection(db, "lm_visits"), {
          page: "home",
          device: navigator.userAgent,
          createdAt: serverTimestamp()
        });
      } catch (error) {
        console.error("Visit tracking failed:", error);
      }
    }

    trackVisit();



    /* ==========================
       BOOK VIEW TRACKING
    ========================== */

    const bookImage = document.getElementById("bookImage");

    bookImage.addEventListener("click", async () => {
      try {
        await addDoc(collection(db, "lm_book_views"), {
          createdAt: serverTimestamp()
        });
      } catch (error) {
        console.error("Book view tracking failed:", error);
      }
    });



    /* ==========================
       CONSULTATION FORM
    ========================== */

    const consultForm = document.getElementById("consultForm");

    consultForm.addEventListener("submit", async (e) => {
      e.preventDefault();

      const fullName = document.getElementById("fullName").value;
      const email = document.getElementById("email").value;
      const message = document.getElementById("message").value;

      try {
        await addDoc(collection(db, "lm_queries"), {
          fullName,
          email,
          message,
          status: "new",
          createdAt: serverTimestamp()
        });

        alert("Query Submitted Successfully ðŸ”¥");
        consultForm.reset();

      } catch (error) {
        console.error("Consultation submit error:", error);
        alert("Something went wrong. Try again.");
      }
    });



    /* ==========================
       BOOK INTEREST FORM
    ========================== */

    const bookForm = document.getElementById("bookForm");

    bookForm.addEventListener("submit", async (e) => {
      e.preventDefault();

      const bookName = document.getElementById("bookName").value;
      const bookEmail = document.getElementById("bookEmail").value;
      const interestedIn = document.getElementById("interestedIn").value;

      if (!interestedIn) {
        alert("Please select your interest type.");
        return;
      }

      try {
        await addDoc(collection(db, "lm_book_interest"), {
          fullName: bookName,
          email: bookEmail,
          interestedIn,
          earlyAccessConsent: true,
          notified: false,
          createdAt: serverTimestamp()
        });

        alert("You're Registered for Early Access ðŸ”¥");
        bookForm.reset();

      } catch (error) {
        console.error("Book interest error:", error);
        alert("Something went wrong. Try again.");
      }
    });

  </script>

</body>
</html>

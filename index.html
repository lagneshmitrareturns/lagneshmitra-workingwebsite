<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LagneshMitra | Vedic Astrology & Publishing</title>

  <meta name="description" content="Vedic Astrology with Structure. Book early access for Kaalprehari â€“ The Dera Massacre. Consultation & Commercial Thriller Publishing.">
  <link rel="stylesheet" href="style.css" />
</head>

<body>

  <!-- HERO SECTION -->
  <section class="hero">
    <h1>LagneshMitra</h1>
    <p>Vedic Astrology with Structure â€¢ Not Guesswork</p>

    <div class="cta-buttons">
      <a href="#consult" class="btn">Book Consultation</a>
      <a href="#book" class="btn secondary">Kaalprehari â€“ Early Access</a>
    </div>
  </section>


  <!-- SERVICES -->
  <section id="consult" class="section">
    <h2>Consultation Services</h2>

    <ul class="services">
      <li>Short Structured Consultation</li>
      <li>Summary Personality Report</li>
      <li>Marriage & Compatibility Analysis</li>
      <li>Karmic Debt Report (D30/D60)</li>
      <li>Advanced Premium Analysis</li>
    </ul>

    <form id="consultForm" class="form">
      <input type="text" id="fullName" placeholder="Full Name" required />
      <input type="email" id="email" placeholder="Email Address" required />
      <textarea id="message" placeholder="Your Query"></textarea>
      <button type="submit" class="btn">Submit Query</button>
    </form>
  </section>


  <!-- BOOK SECTION -->
  <section id="book" class="section dark">
    <h2>Kaalprehari â€“ The Dera Massacre</h2>

    <img src="kaalprehari.jpg" alt="Kaalprehari Book Cover" class="book-image"/>

    <p class="tagline">
      Full Ebook Coming Soon... <br>
      World Wide Release on KDP & Other Platforms
    </p>

    <p>
      Book Your Copies â€“ Early Access <br>
      Ebook will be directly sent to your email.
    </p>

    <form id="bookForm" class="form">
      <input type="text" id="bookName" placeholder="Full Name" required />
      <input type="email" id="bookEmail" placeholder="Email Address" required />

      <select id="interestedIn" required>
        <option value="">Interested In</option>
        <option value="ebook">Ebook</option>
        <option value="paperback">Paperback</option>
        <option value="hardcover">Hardcover</option>
      </select>

      <button type="submit" class="btn">I'm Interested</button>
    </form>
  </section>


  <!-- FOOTER -->
  <footer>
    <p>Â© LagneshMitra & Zonies Hub Originals</p>
  </footer>


  <!-- FIREBASE -->
  <script type="module">
    import { db } from "./firebase-config.js";
    import {
      collection,
      addDoc,
      serverTimestamp
    } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";


    /* --------------------------
       VISIT TRACKING
    --------------------------- */
    async function trackVisit() {
      try {
        await addDoc(collection(db, "lm_visits"), {
          page: "home",
          device: navigator.userAgent,
          createdAt: serverTimestamp()
        });
      } catch (error) {
        console.error("Visit tracking failed:", error);
      }
    }
    trackVisit();


    /* --------------------------
       CONSULTATION FORM
    --------------------------- */
    const consultForm = document.getElementById("consultForm");

    consultForm.addEventListener("submit", async (e) => {
      e.preventDefault();

      const fullName = document.getElementById("fullName").value;
      const email = document.getElementById("email").value;
      const message = document.getElementById("message").value;

      try {
        await addDoc(collection(db, "lm_queries"), {
          fullName,
          email,
          message,
          status: "new",
          createdAt: serverTimestamp()
        });

        alert("Query Submitted Successfully ðŸ”¥");
        consultForm.reset();

      } catch (error) {
        console.error("Consultation submit error:", error);
        alert("Something went wrong. Try again.");
      }
    });


    /* --------------------------
       BOOK INTEREST FORM
    --------------------------- */
    const bookForm = document.getElementById("bookForm");

    bookForm.addEventListener("submit", async (e) => {
      e.preventDefault();

      const bookName = document.getElementById("bookName").value;
      const bookEmail = document.getElementById("bookEmail").value;
      const interestedIn = document.getElementById("interestedIn").value;

      if (!interestedIn) {
        alert("Please select your interest type.");
        return;
      }

      try {
        await addDoc(collection(db, "lm_book_interest"), {
          fullName: bookName,
          email: bookEmail,
          interestedIn,
          earlyAccessConsent: true,
          notified: false,
          createdAt: serverTimestamp()
        });

        alert("You're Registered for Early Access ðŸ”¥");
        bookForm.reset();

      } catch (error) {
        console.error("Book interest error:", error);
        alert("Something went wrong. Try again.");
      }
    });

  </script>

</body>
</html>
